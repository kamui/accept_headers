<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Accept headers by kamui</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Accept headers</h1>
        <p>A ruby library that parses and sorts http accept headers.</p>
        <p class="view"><a href="https://github.com/kamui/accept_headers">View the Project on GitHub <small>kamui/accept_headers</small></a></p>
        <ul>
          <li><a href="https://github.com/kamui/accept_headers/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kamui/accept_headers/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kamui/accept_headers">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><a href="https://travis-ci.org/kamui/accept_headers"><img src="https://travis-ci.org/kamui/accept_headers.png" alt="Build Status"></a>
<a href="https://codeclimate.com/github/kamui/accept_headers"><img src="https://codeclimate.com/github/kamui/accept_headers/badges/gpa.svg" alt="Code Climate"></a>
<a href="https://codeclimate.com/github/kamui/accept_headers"><img src="https://codeclimate.com/github/kamui/accept_headers/badges/coverage.svg" alt="Test Coverage"></a></p>

<h1>
<a id="acceptheaders" class="anchor" href="#acceptheaders" aria-hidden="true"><span class="octicon octicon-link"></span></a>AcceptHeaders</h1>

<p><strong>AcceptHeaders</strong> is a ruby library that parses and sorts http accept headers.</p>

<p>Some features of the library are:</p>

<ul>
<li>Strict adherence to <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">RFC 2616</a>, specifically <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">section 14</a>
</li>
<li>Full support for the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1">Accept</a>, <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.2">Accept-Charset</a>,
<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3">Accept-Encoding</a>, and <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4">Accept-Language</a> HTTP
request headers</li>
<li>A comprehensive <a href="http://github.com/kamui/accept_headers/tree/master/spec/">spec suite</a> that covers many edge cases</li>
</ul>

<p>This library is optimistic when parsing headers. If a specific media type, encoding, charset, or language can't be parsed, is in an invalid format, or contains invalid characters, it will skip that specific entry when constructing the sorted list. If a <code>q</code> value can't be read or is in the wrong format (more than 3 decimal places), it will default it to <code>0.001</code> so it still has a chance to match. Lack of an explicit <code>q</code> value of course defaults to 1.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-mr"><span class="pl-kos">gem</span> <span class="pl-s1"><span class="pl-pds">'</span>accept_headers<span class="pl-pds">'</span></span></span></pre></div>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install accept_headers
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p><code>AcceptHeaders</code> can parse the Accept Header and return an array of <code>MediaType</code>s in descending order according to the spec, which takes into account <code>q</code> value, <code>type</code>/<code>subtype</code> and <code>params</code> specificity.</p>

<div class="highlight highlight-ruby"><pre><span class="pl-sc">AcceptHeaders</span>::<span class="pl-sc">MediaType</span>.parse(<span class="pl-s1"><span class="pl-pds">"</span>text/*;q=0.3, text/html;q=0.7, text/html;level=1, text/html;level=2;q=0.4, */*;q=0.5<span class="pl-pds">"</span></span>)</pre></div>

<p>Will generate this equivalent array:</p>

<div class="highlight highlight-ruby"><pre>[
  <span class="pl-sc">MediaType</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>, <span class="pl-cos">params<span class="pl-pdc1">:</span></span> { <span class="pl-s1"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span> =&gt; <span class="pl-s1"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span> }),
  <span class="pl-sc">MediaType</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.7</span>),
  <span class="pl-sc">MediaType</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.5</span>),
  <span class="pl-sc">MediaType</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.4</span>, <span class="pl-cos">params<span class="pl-pdc1">:</span></span> { <span class="pl-s1"><span class="pl-pds">'</span>level<span class="pl-pds">'</span></span> =&gt; <span class="pl-s1"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span> }),
  <span class="pl-sc">MediaType</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.3</span>)
]</pre></div>

<p>Parsing <code>Charset</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-sc">AcceptHeaders</span>::<span class="pl-sc">Charset</span>.parse(<span class="pl-s1"><span class="pl-pds">"</span>us-ascii; q=0.5, iso-8859-1, utf-8; q=0.8, macintosh<span class="pl-pds">"</span></span>)</pre></div>

<p>generates:</p>

<div class="highlight highlight-ruby"><pre>[
  <span class="pl-sc">Charset</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>iso-8859-1<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Charset</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>macintosh<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Charset</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>utf-8<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.8</span>),
  <span class="pl-sc">Charset</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>us-ascii<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.5</span>)
]</pre></div>

<p>Parsing <code>Encoding</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-sc">AcceptHeaders</span>::<span class="pl-sc">Encoding</span>.parse(<span class="pl-s1"><span class="pl-pds">"</span>deflate; q=0.5, gzip, compress; q=0.8, identity<span class="pl-pds">"</span></span>)</pre></div>

<p>generates:</p>

<div class="highlight highlight-ruby"><pre>[
  <span class="pl-sc">Encoding</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>gzip<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Encoding</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>identity<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Encoding</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>compress<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.8</span>),
  <span class="pl-sc">Encoding</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>deflate<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.5</span>)
]</pre></div>

<p>Parsing <code>Language</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-sc">AcceptHeaders</span>::<span class="pl-sc">Language</span>.parse(<span class="pl-s1"><span class="pl-pds">"</span>en-*, en-us, *;q=0.8<span class="pl-pds">"</span></span>)</pre></div>

<p>generates:</p>

<div class="highlight highlight-ruby"><pre>[
  <span class="pl-sc">Language</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>en<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>us<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Language</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>en<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>),
  <span class="pl-sc">Language</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, <span class="pl-cos">q<span class="pl-pdc1">:</span></span> <span class="pl-cn">0.8</span>)
]</pre></div>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Todo</h2>

<ul>
<li>Write rack middleware</li>
<li>Add methods to return a best match depending on a list of supported inputs</li>
</ul>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it ( <a href="https://github.com/%5Bmy-github-username%5D/accept_headers/fork">https://github.com/[my-github-username]/accept_headers/fork</a> )</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/kamui">kamui</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-18119942-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>